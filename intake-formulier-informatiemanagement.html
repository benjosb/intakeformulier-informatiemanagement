<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Intakeformulier Informatiemanagement</title>
<style>
/* ═══════════════════════════════════════════════════════════════════════════
   WASSENAAR GROEN - INTAKE FORMULIER v2
   Three-column layout: Icon Rail | Sidebar | Content Pane
   ═══════════════════════════════════════════════════════════════════════════ */

:root {
  /* Wassenaar Donkergroen palette */
  --wassenaar: #1B4D3E;
  --wassenaar-dark: #133528;
  --wassenaar-light: #2A6B54;
  --wassenaar-pale: #E8F0ED;
  
  /* Functional colors */
  --bg: #F5F7F6;
  --card: #FFFFFF;
  --text: #1A2E28;
  --text-muted: #5A6F68;
  --border: rgba(27, 77, 62, 0.12);
  --border-strong: rgba(27, 77, 62, 0.25);
  
  /* State colors */
  --empty: #F9EDD5;
  --empty-border: #E8C864;
  --filled: #E3F2E8;
  --filled-border: #2A6B54;
  --accent: #0A7B6C;
  
  /* Layout */
  --rail-width: 56px;
  --sidebar-width: 220px;
  --radius: 8px;
  --radius-sm: 6px;
}

* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

html, body {
  height: 100%;
  overflow: hidden;
}

body {
  font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
  font-size: 14px;
  line-height: 1.5;
  color: var(--text);
  background: var(--bg);
}

/* ═══════════════════════════════════════════════════════════════════════════
   MAIN LAYOUT - Three Columns
   ═══════════════════════════════════════════════════════════════════════════ */

.app {
  display: flex;
  height: 100vh;
  width: 100vw;
}

/* ─────────────────────────────────────────────────────────────────────────────
   COLUMN 1: Icon Rail (Meta Navigation)
   ───────────────────────────────────────────────────────────────────────────── */

.icon-rail {
  width: var(--rail-width);
  min-width: var(--rail-width);
  background: var(--wassenaar);
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 12px 0;
  gap: 4px;
}

.rail-logo {
  width: 36px;
  height: 36px;
  background: var(--wassenaar-light);
  border-radius: var(--radius);
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-weight: 700;
  font-size: 14px;
  margin-bottom: 12px;
}

.rail-divider {
  width: 24px;
  height: 1px;
  background: rgba(255,255,255,0.15);
  margin: 8px 0;
}

.rail-btn {
  width: 40px;
  height: 40px;
  border: none;
  background: transparent;
  color: rgba(255,255,255,0.6);
  border-radius: var(--radius);
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.15s ease;
  position: relative;
}

.rail-btn:hover {
  background: rgba(255,255,255,0.1);
  color: white;
}

.rail-btn.active {
  background: rgba(255,255,255,0.15);
  color: white;
}

.rail-btn svg {
  width: 20px;
  height: 20px;
}

.rail-btn[data-tooltip]:hover::after {
  content: attr(data-tooltip);
  position: absolute;
  left: calc(100% + 8px);
  top: 50%;
  transform: translateY(-50%);
  background: var(--text);
  color: white;
  padding: 6px 10px;
  border-radius: var(--radius-sm);
  font-size: 12px;
  white-space: nowrap;
  z-index: 1000;
  pointer-events: none;
}

.rail-spacer {
  flex: 1;
}

.rail-btn.danger:hover {
  background: rgba(180, 35, 24, 0.2);
  color: #FF6B5B;
}

/* ─────────────────────────────────────────────────────────────────────────────
   COLUMN 2: Sidebar (Block Navigation)
   ───────────────────────────────────────────────────────────────────────────── */

.sidebar {
  width: var(--sidebar-width);
  min-width: var(--sidebar-width);
  background: white;
  border-right: 1px solid var(--border);
  display: flex;
  flex-direction: column;
}

.sidebar-header {
  padding: 16px;
  border-bottom: 1px solid var(--border);
}

.sidebar-title {
  font-size: 11px;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  color: var(--text-muted);
  font-weight: 600;
}

.sidebar-nav {
  flex: 1;
  padding: 8px;
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.nav-item {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 12px;
  border: none;
  background: transparent;
  border-radius: var(--radius);
  cursor: pointer;
  text-align: left;
  color: var(--text-muted);
  font-size: 13px;
  font-weight: 500;
  transition: all 0.15s ease;
  width: 100%;
}

.nav-item:hover {
  background: var(--wassenaar-pale);
  color: var(--wassenaar);
}

.nav-item.active {
  background: var(--wassenaar);
  color: white;
}

.nav-item .nav-icon {
  width: 18px;
  height: 18px;
  opacity: 0.7;
}

.nav-item.active .nav-icon {
  opacity: 1;
}

.nav-item .nav-label {
  flex: 1;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.sidebar-footer {
  padding: 12px 16px;
  border-top: 1px solid var(--border);
  font-size: 11px;
  color: var(--text-muted);
}

/* ─────────────────────────────────────────────────────────────────────────────
   COLUMN 3: Content Pane
   ───────────────────────────────────────────────────────────────────────────── */

.content-pane {
  flex: 1;
  display: flex;
  flex-direction: column;
  min-width: 0;
  background: var(--bg);
}

.content-header {
  padding: 16px 24px;
  background: white;
  border-bottom: 1px solid var(--border);
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 16px;
}

.content-title {
  font-size: 18px;
  font-weight: 600;
  color: var(--wassenaar);
}

.content-subtitle {
  font-size: 12px;
  color: var(--text-muted);
  margin-top: 2px;
}

.header-left {
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.header-titles {
  display: flex;
  flex-direction: column;
}

.process-name-display {
  font-size: 24px;
  color: var(--wassenaar);
  font-weight: 600;
  font-family: Georgia, 'Times New Roman', serif;
  font-style: italic;
  padding: 6px 14px;
  background: linear-gradient(135deg, var(--wassenaar-pale) 0%, rgba(232, 240, 237, 0.4) 100%);
  border-left: 3px solid var(--wassenaar);
  border-radius: 0 var(--radius) var(--radius) 0;
  margin-top: 6px;
}

.header-logo {
  height: 52px;
  width: auto;
  flex-shrink: 0;
}

.content-body {
  flex: 1;
  padding: 20px 24px;
  overflow-y: auto;
}

/* ═══════════════════════════════════════════════════════════════════════════
   FORM PANELS
   ═══════════════════════════════════════════════════════════════════════════ */

.panel {
  display: none;
  height: 100%;
}

.panel.active {
  display: block;
}

.panel-card {
  background: white;
  border-radius: var(--radius);
  border: 1px solid var(--border);
  padding: 20px;
  height: calc(100vh - 140px);
  overflow-y: auto;
}

.field-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 16px;
}

.field {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.field.full {
  grid-column: 1 / -1;
}

.field label,
.field > span {
  font-size: 12px;
  font-weight: 600;
  color: var(--text-muted);
}

.field[data-state="filled"] > span {
  color: var(--wassenaar);
}

input[type="text"],
input[type="date"],
select,
textarea {
  width: 100%;
  padding: 10px 12px;
  border: 1px solid var(--border-strong);
  border-radius: var(--radius-sm);
  font-size: 14px;
  font-family: inherit;
  color: var(--text);
  background: white;
  transition: all 0.15s ease;
}

input:focus,
select:focus,
textarea:focus {
  outline: none;
  border-color: var(--wassenaar);
  box-shadow: 0 0 0 3px rgba(27, 77, 62, 0.1);
}

textarea {
  min-height: 80px;
  resize: vertical;
}

/* Field states */
.field[data-state="empty"] input,
.field[data-state="empty"] select,
.field[data-state="empty"] textarea {
  background: var(--empty);
  border-color: var(--empty-border);
}

.field[data-state="filled"] input,
.field[data-state="filled"] select,
.field[data-state="filled"] textarea {
  background: var(--filled);
  border-color: var(--filled-border);
}

/* ═══════════════════════════════════════════════════════════════════════════
   SAMENVATTING PANEL (Special layout)
   ═══════════════════════════════════════════════════════════════════════════ */

.summary-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 12px;
  margin-bottom: 20px;
}

.status-card {
  background: var(--wassenaar-pale);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 12px;
}

.status-card .status-label {
  font-size: 11px;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: var(--text-muted);
  margin-bottom: 6px;
}

.status-card select {
  background: white;
}

.summary-textarea {
  width: 100%;
}

.summary-textarea textarea {
  min-height: 100px;
}

.summary-textarea label {
  display: block;
  font-size: 12px;
  font-weight: 600;
  color: var(--text-muted);
  margin-bottom: 6px;
}

/* ═══════════════════════════════════════════════════════════════════════════
   TOAST NOTIFICATIONS
   ═══════════════════════════════════════════════════════════════════════════ */

.toast {
  position: fixed;
  bottom: 24px;
  right: 24px;
  background: var(--wassenaar);
  color: white;
  padding: 12px 20px;
  border-radius: var(--radius);
  font-size: 13px;
  font-weight: 500;
  opacity: 0;
  transform: translateY(10px);
  transition: all 0.3s ease;
  pointer-events: none;
  z-index: 9999;
}

.toast.show {
  opacity: 1;
  transform: translateY(0);
}

/* ═══════════════════════════════════════════════════════════════════════════
   WIZARD OVERLAY (future)
   ═══════════════════════════════════════════════════════════════════════════ */

.wizard-overlay {
  position: fixed;
  inset: 0;
  background: rgba(27, 77, 62, 0.95);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 10000;
}

.wizard-overlay.active {
  display: flex;
}

.wizard-content {
  background: white;
  border-radius: var(--radius);
  padding: 32px;
  max-width: 600px;
  width: 90%;
  text-align: center;
}

.wizard-content h2 {
  color: var(--wassenaar);
  margin-bottom: 12px;
}

.wizard-content p {
  color: var(--text-muted);
  margin-bottom: 24px;
}

.wizard-close {
  padding: 10px 24px;
  background: var(--wassenaar);
  color: white;
  border: none;
  border-radius: var(--radius);
  cursor: pointer;
  font-size: 14px;
  font-weight: 500;
}

/* ═══════════════════════════════════════════════════════════════════════════
   PRINT STYLES
   ═══════════════════════════════════════════════════════════════════════════ */

@media print {
  .icon-rail, .sidebar, .content-header, .toast, .wizard-overlay {
    display: none !important;
  }
  
  .app {
    display: block;
    height: auto;
  }
  
  .content-pane {
    width: 100%;
  }
  
  .content-body {
    padding: 0;
  }
  
  .panel {
    display: block !important;
    page-break-after: always;
  }
  
  .panel-card {
    height: auto;
    overflow: visible;
    box-shadow: none;
    border: none;
  }
}
</style>
</head>
<body>

<div class="app">
  <!-- ═══════════════════════════════════════════════════════════════════════
       COLUMN 1: Icon Rail
       ═══════════════════════════════════════════════════════════════════════ -->
  <nav class="icon-rail">
    <div class="rail-logo">IM</div>
    
    <button class="rail-btn" data-action="new" data-tooltip="Nieuw formulier">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
        <polyline points="14 2 14 8 20 8"/>
        <line x1="12" y1="18" x2="12" y2="12"/>
        <line x1="9" y1="15" x2="15" y2="15"/>
      </svg>
    </button>
    
    <button class="rail-btn" data-action="load" data-tooltip="Openen (JSON)">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
        <polyline points="17 8 12 3 7 8"/>
        <line x1="12" y1="3" x2="12" y2="15"/>
      </svg>
    </button>
    
    <div class="rail-divider"></div>
    
    <button class="rail-btn" data-action="save" data-tooltip="Opslaan (JSON)">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
        <polyline points="17 21 17 13 7 13 7 21"/>
        <polyline points="7 3 7 8 15 8"/>
      </svg>
    </button>
    
    <button class="rail-btn" data-action="pdf" data-tooltip="Export PDF">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
        <polyline points="14 2 14 8 20 8"/>
        <line x1="16" y1="13" x2="8" y2="13"/>
        <line x1="16" y1="17" x2="8" y2="17"/>
        <polyline points="10 9 9 9 8 9"/>
      </svg>
    </button>
    
    <button class="rail-btn" data-action="word" data-tooltip="Export Word">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M4 4h16v16H4z"/>
        <path d="M8 8l2 8 2-6 2 6 2-8"/>
      </svg>
    </button>
    
    <button class="rail-btn" data-action="html" data-tooltip="Export HTML">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <polyline points="16 18 22 12 16 6"/>
        <polyline points="8 6 2 12 8 18"/>
      </svg>
    </button>
    
    <div class="rail-divider"></div>
    
    <button class="rail-btn" data-action="wizard" data-tooltip="Wizard (vraagassistent)">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
      </svg>
    </button>
    
    <button class="rail-btn" data-action="history" data-tooltip="Historie">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <circle cx="12" cy="12" r="10"/>
        <polyline points="12 6 12 12 16 14"/>
      </svg>
    </button>
    
    <div class="rail-spacer"></div>
    
    <button class="rail-btn" data-action="darkmode" data-tooltip="Donkere modus">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
      </svg>
    </button>
  </nav>

  <!-- ═══════════════════════════════════════════════════════════════════════
       COLUMN 2: Sidebar
       ═══════════════════════════════════════════════════════════════════════ -->
  <aside class="sidebar">
    <div class="sidebar-header">
      <div class="sidebar-title">Blokken</div>
    </div>
    
    <nav class="sidebar-nav">
      <button class="nav-item active" data-target="samenvatting">
        <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <rect x="3" y="3" width="7" height="7"/>
          <rect x="14" y="3" width="7" height="7"/>
          <rect x="14" y="14" width="7" height="7"/>
          <rect x="3" y="14" width="7" height="7"/>
        </svg>
        <span class="nav-label">Samenvatting</span>
      </button>
      
      <button class="nav-item" data-target="blok-1">
        <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
          <circle cx="12" cy="7" r="4"/>
        </svg>
        <span class="nav-label">1. Basisinformatie</span>
      </button>
      
      <button class="nav-item" data-target="blok-2">
        <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"/>
          <line x1="12" y1="16" x2="12" y2="12"/>
          <line x1="12" y1="8" x2="12.01" y2="8"/>
        </svg>
        <span class="nav-label">2. Informatiebehoefte</span>
      </button>
      
      <button class="nav-item" data-target="blok-3">
        <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <rect x="2" y="3" width="20" height="14" rx="2" ry="2"/>
          <line x1="8" y1="21" x2="16" y2="21"/>
          <line x1="12" y1="17" x2="12" y2="21"/>
        </svg>
        <span class="nav-label">3. Applicatie</span>
      </button>
      
      <button class="nav-item" data-target="blok-4">
        <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
          <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
        </svg>
        <span class="nav-label">4. Beveiliging & Privacy</span>
      </button>
      
      <button class="nav-item" data-target="blok-5">
        <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polygon points="12 2 2 7 12 12 22 7 12 2"/>
          <polyline points="2 17 12 22 22 17"/>
          <polyline points="2 12 12 17 22 12"/>
        </svg>
        <span class="nav-label">5. Architectuur</span>
      </button>
    </nav>
    
    <div class="sidebar-footer">
      Versie 2.0.0
    </div>
  </aside>

  <!-- ═══════════════════════════════════════════════════════════════════════
       COLUMN 3: Content Pane
       ═══════════════════════════════════════════════════════════════════════ -->
  <main class="content-pane">
    <header class="content-header">
      <div class="header-left">
        <div class="header-titles">
          <h1 class="content-title">Intakeformulier Informatiemanagement</h1>
          <p class="content-subtitle">Impactanalyse I&D</p>
        </div>
        <div class="process-name-display" id="process-display">Geen proces geselecteerd</div>
      </div>
      <object type="image/svg+xml" data="wassenaar_logo_fc.svg" class="header-logo">Gemeente Wassenaar</object>
    </header>
    
    <div class="content-body">
      <form id="intake-form">
        
        <!-- ═════════════════════════════════════════════════════════════════
             PANEL: Samenvatting
             ═════════════════════════════════════════════════════════════════ -->
        <div class="panel active" id="samenvatting" data-section="Samenvatting">
          <div class="panel-card">
            <div class="summary-textarea" style="margin-bottom: 20px;">
              <label>Korte samenvatting</label>
              <textarea data-field="summary" data-label="Samenvatting" placeholder="Geef een beknopte samenvatting van dit initiatief..."></textarea>
            </div>
            
            <div class="summary-grid">
              <div class="status-card">
                <div class="status-label">Status Initiatief</div>
                <select data-field="status" data-label="Status">
                  <option value="">Kies status</option>
                  <option>In behandeling</option>
                  <option>Afstemming nodig</option>
                  <option>Afgerond</option>
                  <option>On hold</option>
                </select>
              </div>
              
              <div class="status-card">
                <div class="status-label">Informatiemanagement</div>
                <select data-field="informatiemanagement" data-label="Informatiemanagement">
                  <option value="">Kies status</option>
                  <option>Niet gestart</option>
                  <option>Onderzoek loopt</option>
                  <option>Akkoord</option>
                  <option>Niet akkoord</option>
                </select>
              </div>
              
              <div class="status-card">
                <div class="status-label">Privacy</div>
                <select data-field="privacy" data-label="Privacy">
                  <option value="">Kies status</option>
                  <option>Niet gestart</option>
                  <option>Onderzoek loopt</option>
                  <option>Akkoord</option>
                  <option>Niet van toepassing</option>
                </select>
              </div>
              
              <div class="status-card">
                <div class="status-label">Informatieveiligheid</div>
                <select data-field="informatieveiligheid" data-label="Informatieveiligheid">
                  <option value="">Kies status</option>
                  <option>Niet gestart</option>
                  <option>Onderzoek loopt</option>
                  <option>Akkoord</option>
                  <option>Niet akkoord</option>
                </select>
              </div>
              
              <div class="status-card">
                <div class="status-label">Functioneel Beheer</div>
                <select data-field="functioneel-beheer" data-label="Functioneel Beheer">
                  <option value="">Kies status</option>
                  <option>Niet gestart</option>
                  <option>Capaciteit nodig</option>
                  <option>Ingeregeld</option>
                </select>
              </div>
              
              <div class="status-card">
                <div class="status-label">Technisch Beheer</div>
                <select data-field="technisch-beheer" data-label="Technisch Beheer">
                  <option value="">Kies status</option>
                  <option>Niet gestart</option>
                  <option>Afhankelijkheden</option>
                  <option>Ingeregeld</option>
                </select>
              </div>
              
              <div class="status-card">
                <div class="status-label">Architectuur</div>
                <select data-field="architectuur" data-label="Architectuur">
                  <option value="">Kies status</option>
                  <option>Niet gestart</option>
                  <option>Onderzoek loopt</option>
                  <option>Akkoord</option>
                </select>
              </div>
              
              <div class="status-card">
                <div class="status-label">Archivering</div>
                <select data-field="archivering" data-label="Archivering">
                  <option value="">Kies status</option>
                  <option>Niet gestart</option>
                  <option>Onderzoek loopt</option>
                  <option>Akkoord</option>
                  <option>Niet van toepassing</option>
                </select>
              </div>
              
              <div class="status-card">
                <div class="status-label">Inkoop</div>
                <select data-field="inkoop" data-label="Inkoop">
                  <option value="">Kies status</option>
                  <option>Niet gestart</option>
                  <option>Onderhandeling</option>
                  <option>Afgerond</option>
                </select>
              </div>
            </div>
            
            <div class="summary-textarea">
              <label>Bijdrage aan organisatiedoelen</label>
              <textarea data-field="contribution" data-label="Bijdrage aan organisatiedoelen" placeholder="Hoe draagt dit initiatief bij aan de organisatiedoelen?"></textarea>
            </div>
          </div>
        </div>

        <!-- ═════════════════════════════════════════════════════════════════
             PANEL: Blok 1 - Basisinformatie
             ═════════════════════════════════════════════════════════════════ -->
        <div class="panel" id="blok-1" data-section="Blok 1. Basisinformatie">
          <div class="panel-card">
            <div class="field-grid">
              <div class="field">
                <span>Procesnaam</span>
                <input type="text" data-field="procesnaam" data-label="Procesnaam" placeholder="Naam van het proces of systeem">
              </div>
              
              <div class="field">
                <span>Proceseigenaar</span>
                <input type="text" data-field="proceseigenaar" data-label="Proceseigenaar" placeholder="Naam proceseigenaar">
              </div>
              
              <div class="field">
                <span>Verzoeker / Contactpersoon</span>
                <input type="text" data-field="verzoeker" data-label="Verzoeker" placeholder="Naam verzoeker">
              </div>
              
              <div class="field">
                <span>Datum intake</span>
                <input type="date" data-field="datum-intake" data-label="Datum intake">
              </div>
              
              <div class="field full">
                <span>Wettelijke grondslag</span>
                <textarea data-field="wettelijke-grondslag" data-label="Wettelijke grondslag" placeholder="Relevante wet- en regelgeving"></textarea>
              </div>
              
              <div class="field full">
                <span>Financiële dekking</span>
                <textarea data-field="financiele-dekking" data-label="Financiële dekking" placeholder="Budget en kostenplaats"></textarea>
              </div>
              
              <div class="field">
                <span>Betreft gemeente(n)</span>
                <select data-field="behoefte-gemeenten" data-label="Betreft gemeente(n)">
                  <option value="">Selecteer</option>
                  <option>Alleen Wassenaar</option>
                  <option>Alleen Voorschoten</option>
                  <option>Beide gemeenten</option>
                </select>
              </div>
              
              <div class="field">
                <span>A3 Jaarplan status</span>
                <select data-field="a3-status" data-label="A3 status">
                  <option value="">Selecteer</option>
                  <option>Opgenomen</option>
                  <option>Niet opgenomen</option>
                  <option>Gedeeltelijk / indirect</option>
                </select>
              </div>
              
              <div class="field full">
                <span>Afstemming</span>
                <textarea data-field="afstemming" data-label="Afstemming" placeholder="Welke afstemming heeft plaatsgevonden?"></textarea>
              </div>
            </div>
          </div>
        </div>

        <!-- ═════════════════════════════════════════════════════════════════
             PANEL: Blok 2 - Informatiebehoefte
             ═════════════════════════════════════════════════════════════════ -->
        <div class="panel" id="blok-2" data-section="Blok 2. Informatiebehoefte">
          <div class="panel-card">
            <div class="field-grid">
              <div class="field full">
                <span>Behoefte en aanleiding</span>
                <textarea data-field="behoefte-aanleiding" data-label="Behoefte en aanleiding" placeholder="Wat is de aanleiding voor dit verzoek?"></textarea>
              </div>
              
              <div class="field">
                <span>Opgenomen in A3 jaarplan?</span>
                <select data-field="a3-opgenomen" data-label="Opgenomen in A3 jaarplan">
                  <option value="">Selecteer</option>
                  <option>Ja</option>
                  <option>Nee</option>
                  <option>Indirect / via ander initiatief</option>
                </select>
              </div>
              
              <div class="field">
                <span>Type aanvraag</span>
                <select data-field="type-aanvraag" data-label="Type aanvraag">
                  <option value="">Selecteer</option>
                  <option>Nieuwe oplossing</option>
                  <option>Vervanging bestaande oplossing</option>
                  <option>Uitbreiding / wijziging</option>
                  <option>Contractverlenging</option>
                  <option>Pilot / proef</option>
                </select>
              </div>
              
              <div class="field full">
                <span>Huidige situatie</span>
                <textarea data-field="huidige-situatie" data-label="Huidige situatie" placeholder="Beschrijf de huidige situatie"></textarea>
              </div>
              
              <div class="field full">
                <span>Risico's als huidige situatie blijft bestaan</span>
                <textarea data-field="risicos" data-label="Risico's huidige situatie" placeholder="Welke risico's zijn er?"></textarea>
              </div>
              
              <div class="field full">
                <span>Gewenste situatie</span>
                <textarea data-field="gewenste-situatie" data-label="Gewenste situatie" placeholder="Beschrijf de gewenste eindsituatie"></textarea>
              </div>
              
              <div class="field full">
                <span>Wat levert het op?</span>
                <textarea data-field="opbrengsten" data-label="Wat levert het op" placeholder="Concrete opbrengsten en voordelen"></textarea>
              </div>
            </div>
          </div>
        </div>

        <!-- ═════════════════════════════════════════════════════════════════
             PANEL: Blok 3 - Applicatie & marktverkenning
             ═════════════════════════════════════════════════════════════════ -->
        <div class="panel" id="blok-3" data-section="Blok 3. Applicatie & marktverkenning">
          <div class="panel-card">
            <div class="field-grid">
              <div class="field full">
                <span>Bestaande interne oplossing?</span>
                <textarea data-field="interne-oplossing" data-label="Bestaande interne oplossing" placeholder="Is er al een interne oplossing beschikbaar?"></textarea>
              </div>
              
              <div class="field">
                <span>Bekend met SW-broker?</span>
                <select data-field="sw-broker-bekend" data-label="Bekend met SW-broker">
                  <option value="">Selecteer</option>
                  <option>Ja</option>
                  <option>Nee</option>
                  <option>In verkenning</option>
                </select>
              </div>
              
              <div class="field">
                <span>SLA of DVO aanwezig?</span>
                <select data-field="sla-dvo" data-label="SLA of DVO">
                  <option value="">Selecteer</option>
                  <option>Ja, actueel</option>
                  <option>Ja, verouderd</option>
                  <option>Nee</option>
                  <option>Nog te bepalen</option>
                </select>
              </div>
              
              <div class="field full">
                <span>VNG Softwarecatalogus</span>
                <textarea data-field="vng-catalogus" data-label="VNG Softwarecatalogus" placeholder="Verkenning via VNG catalogus"></textarea>
              </div>
              
              <div class="field full">
                <span>Koppeling met DigiD, eHerkenning of eIDAS</span>
                <textarea data-field="koppeling-id" data-label="Koppeling met DigiD/eHerkenning/eIDAS"></textarea>
              </div>
              
              <div class="field">
                <span>Behoefte aan functioneel beheer?</span>
                <select data-field="fb-behoefte" data-label="Behoefte functioneel beheer">
                  <option value="">Selecteer</option>
                  <option>Ja, intern</option>
                  <option>Ja, extern</option>
                  <option>Deels (co-sourcing)</option>
                  <option>Nee</option>
                </select>
              </div>
              
              <div class="field">
                <span>Type functioneel beheer</span>
                <select data-field="fb-type" data-label="Type functioneel beheer">
                  <option value="">Selecteer</option>
                  <option>Lokaal</option>
                  <option>Centraal</option>
                  <option>Hybride</option>
                  <option>Extern</option>
                </select>
              </div>
            </div>
          </div>
        </div>

        <!-- ═════════════════════════════════════════════════════════════════
             PANEL: Blok 4 - Informatiebeveiliging & privacy
             ═════════════════════════════════════════════════════════════════ -->
        <div class="panel" id="blok-4" data-section="Blok 4. Informatiebeveiliging & privacy">
          <div class="panel-card">
            <div class="field-grid">
              <div class="field full">
                <span>Toetsing aan BIO2-eisen</span>
                <textarea data-field="bio2" data-label="Toetsing aan BIO2-eisen"></textarea>
              </div>
              
              <div class="field full">
                <span>Toetsing aan NIS2-eisen</span>
                <textarea data-field="nis2" data-label="Toetsing aan NIS2-eisen"></textarea>
              </div>
              
              <div class="field">
                <span>Voldoet aan BIO2 en NIS2?</span>
                <select data-field="bio2-conform" data-label="Voldoet aan BIO2/NIS2">
                  <option value="">Selecteer</option>
                  <option>Ja</option>
                  <option>Nee</option>
                  <option>Deels</option>
                  <option>N.t.b.</option>
                </select>
              </div>
              
              <div class="field">
                <span>Voldoet aan ISO 27001?</span>
                <select data-field="iso27001" data-label="Voldoet aan ISO 27001">
                  <option value="">Selecteer</option>
                  <option>Ja</option>
                  <option>Nee</option>
                  <option>Onder voorwaarden</option>
                  <option>N.t.b.</option>
                </select>
              </div>
              
              <div class="field">
                <span>Verwerken van persoonsgegevens?</span>
                <select data-field="persoonsgegevens" data-label="Verwerken van persoonsgegevens">
                  <option value="">Selecteer</option>
                  <option>Geen persoonsgegevens</option>
                  <option>Gewone persoonsgegevens</option>
                  <option>Gevoelige/bijzondere gegevens</option>
                  <option>Nader onderzoek nodig</option>
                </select>
              </div>
              
              <div class="field">
                <span>Back-up & herstel aanwezig?</span>
                <select data-field="backup" data-label="Back-up & herstel">
                  <option value="">Selecteer</option>
                  <option>Ja</option>
                  <option>Nee</option>
                  <option>Onder voorwaarden</option>
                  <option>N.v.t.</option>
                </select>
              </div>
              
              <div class="field full">
                <span>AVG-grondslag van de verwerking</span>
                <textarea data-field="avg-grondslag" data-label="AVG-grondslag"></textarea>
              </div>
              
              <div class="field full">
                <span>DPIA (Data Protection Impact Assessment)</span>
                <textarea data-field="dpia" data-label="DPIA" placeholder="Is een DPIA uitgevoerd of noodzakelijk?"></textarea>
              </div>
            </div>
          </div>
        </div>

        <!-- ═════════════════════════════════════════════════════════════════
             PANEL: Blok 5 - Architectuur & standaardisatie
             ═════════════════════════════════════════════════════════════════ -->
        <div class="panel" id="blok-5" data-section="Blok 5. Architectuur & standaardisatie">
          <div class="panel-card">
            <div class="field-grid">
              <div class="field full">
                <span>Aansluiting zaaksysteem</span>
                <textarea data-field="zaaksysteem" data-label="Aansluiting zaaksysteem"></textarea>
              </div>
              
              <div class="field full">
                <span>Document-management</span>
                <textarea data-field="document-management" data-label="Document-management"></textarea>
              </div>
              
              <div class="field full">
                <span>Koppelingen met interne/externe systemen</span>
                <textarea data-field="koppelingen" data-label="Koppelingen met interne/externe systemen"></textarea>
              </div>
              
              <div class="field">
                <span>Common Ground oplossing?</span>
                <select data-field="common-ground" data-label="Common Ground">
                  <option value="">Selecteer</option>
                  <option>Ja</option>
                  <option>Nee</option>
                  <option>Onderzoek loopt</option>
                </select>
              </div>
              
              <div class="field">
                <span>Bewaartermijn</span>
                <select data-field="bewaartermijn" data-label="Bewaartermijn">
                  <option value="">Selecteer</option>
                  <option>1 jaar</option>
                  <option>5 jaar</option>
                  <option>7 jaar</option>
                  <option>10 jaar</option>
                  <option>Permanent</option>
                  <option>Nee, zie toelichting</option>
                </select>
              </div>
              
              <div class="field full">
                <span>Gebruik van API's</span>
                <textarea data-field="apis" data-label="Gebruik van API's"></textarea>
              </div>
              
              <div class="field full">
                <span>Metadata (MDTO / Forum Standaardisatie)</span>
                <textarea data-field="metadata" data-label="Metadata"></textarea>
              </div>
            </div>
          </div>
        </div>
        
      </form>
    </div>
  </main>
</div>

<!-- Hidden file input for JSON import -->
<input type="file" id="json-import" accept="application/json" hidden>

<!-- Toast notification -->
<div class="toast" id="toast"></div>

<!-- Wizard overlay (placeholder) -->
<div class="wizard-overlay" id="wizard-overlay">
  <div class="wizard-content">
    <h2>Wizard Modus</h2>
    <p>De vraagassistent wordt nog ontwikkeld. Hier komt de begeleide vraag-voor-vraag modus.</p>
    <button class="wizard-close" id="wizard-close">Sluiten</button>
  </div>
</div>

<script>
(function() {
  // ═══════════════════════════════════════════════════════════════════════════
  // CORE ELEMENTS
  // ═══════════════════════════════════════════════════════════════════════════
  
  const navItems = document.querySelectorAll('.nav-item');
  const panels = document.querySelectorAll('.panel');
  const railButtons = document.querySelectorAll('.rail-btn');
  const fields = document.querySelectorAll('[data-field]');
  const processDisplay = document.getElementById('process-display');
  const toast = document.getElementById('toast');
  const jsonImport = document.getElementById('json-import');
  const wizardOverlay = document.getElementById('wizard-overlay');
  const wizardClose = document.getElementById('wizard-close');
  
  // ═══════════════════════════════════════════════════════════════════════════
  // NAVIGATION
  // ═══════════════════════════════════════════════════════════════════════════
  
  navItems.forEach(item => {
    item.addEventListener('click', () => {
      const target = item.dataset.target;
      
      // Update nav items
      navItems.forEach(n => n.classList.remove('active'));
      item.classList.add('active');
      
      // Update panels
      panels.forEach(p => p.classList.remove('active'));
      document.getElementById(target)?.classList.add('active');
    });
  });
  
  // ═══════════════════════════════════════════════════════════════════════════
  // RAIL ACTIONS
  // ═══════════════════════════════════════════════════════════════════════════
  
  railButtons.forEach(btn => {
    btn.addEventListener('click', () => {
      const action = btn.dataset.action;
      
      switch(action) {
        case 'new':
          if(confirm('Weet je zeker dat je een nieuw formulier wilt starten? Alle niet-opgeslagen wijzigingen gaan verloren.')) {
            resetForm();
          }
          break;
        case 'load':
          jsonImport.click();
          break;
        case 'save':
          saveToJson();
          break;
        case 'pdf':
          window.print();
          break;
        case 'word':
          exportWord();
          break;
        case 'html':
          exportHtml();
          break;
        case 'wizard':
          wizardOverlay.classList.add('active');
          break;
        case 'history':
          showToast('Historie functie komt binnenkort');
          break;
        case 'darkmode':
          showToast('Dark mode komt binnenkort');
          break;
      }
    });
  });
  
  // ═══════════════════════════════════════════════════════════════════════════
  // FIELD STATE MANAGEMENT
  // ═══════════════════════════════════════════════════════════════════════════
  
  function updateFieldState(field) {
    const wrapper = field.closest('.field') || field.closest('.status-card');
    if (!wrapper) return;
    
    let value = field.value?.trim() || '';
    if (field.tagName === 'SELECT') {
      const selected = field.options[field.selectedIndex];
      value = selected && selected.value ? selected.value : '';
    }
    
    wrapper.setAttribute('data-state', value ? 'filled' : 'empty');
  }
  
  function refreshFieldStates() {
    fields.forEach(field => updateFieldState(field));
  }
  
  function updateProcessDisplay() {
    const procesnaam = document.querySelector('[data-field="procesnaam"]');
    if (procesnaam && procesnaam.value.trim()) {
      processDisplay.textContent = procesnaam.value.trim();
    } else {
      processDisplay.textContent = 'Geen proces geselecteerd';
    }
  }
  
  // ═══════════════════════════════════════════════════════════════════════════
  // FORM DATA OPERATIONS
  // ═══════════════════════════════════════════════════════════════════════════
  
  function getFormData() {
    const data = {};
    fields.forEach(field => {
      const key = field.dataset.field;
      data[key] = field.value || '';
    });
    data._meta = {
      version: '2.0.0',
      exportedAt: new Date().toISOString()
    };
    return data;
  }
  
  function setFormData(data) {
    fields.forEach(field => {
      const key = field.dataset.field;
      if (data[key] !== undefined) {
        field.value = data[key];
      }
    });
    refreshFieldStates();
    updateProcessDisplay();
  }
  
  function resetForm() {
    fields.forEach(field => {
      field.value = '';
    });
    refreshFieldStates();
    updateProcessDisplay();
    showToast('Formulier gereset');
  }
  
  // ═══════════════════════════════════════════════════════════════════════════
  // SAVE / LOAD JSON
  // ═══════════════════════════════════════════════════════════════════════════
  
  function saveToJson() {
    const data = getFormData();
    const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const link = document.createElement('a');
    const procesnaam = document.querySelector('[data-field="procesnaam"]')?.value || 'intake';
    const filename = `${procesnaam.toLowerCase().replace(/\s+/g, '-')}-${new Date().toISOString().slice(0,10)}.json`;
    
    link.href = url;
    link.download = filename;
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
    URL.revokeObjectURL(url);
    
    showToast('JSON opgeslagen');
  }
  
  jsonImport.addEventListener('change', (e) => {
    const file = e.target.files[0];
    if (!file) return;
    
    const reader = new FileReader();
    reader.onload = (event) => {
      try {
        const data = JSON.parse(event.target.result);
        setFormData(data);
        showToast('Formulier geladen');
      } catch (err) {
        showToast('Fout bij laden: ongeldig JSON bestand');
      }
    };
    reader.readAsText(file);
    jsonImport.value = '';
  });
  
  // ═══════════════════════════════════════════════════════════════════════════
  // EXPORT FUNCTIONS
  // ═══════════════════════════════════════════════════════════════════════════
  
  function buildReportHtml() {
    const sections = document.querySelectorAll('.panel[data-section]');
    
    const sectionHtml = Array.from(sections).map(section => {
      const title = section.dataset.section;
      const rows = Array.from(section.querySelectorAll('[data-field]')).map(field => {
        const label = field.dataset.label || field.dataset.field;
        let value = field.value || '';
        if (field.tagName === 'SELECT') {
          const selected = field.options[field.selectedIndex];
          value = selected ? selected.text : '';
        }
        if (!value.trim()) return '';
        value = value.replace(/\n/g, '<br>');
        return `<tr><td>${label}</td><td>${value}</td></tr>`;
      }).join('');
      
      if (!rows.trim()) return '';
      return `<div class="section"><h2>${title}</h2><table>${rows}</table></div>`;
    }).join('');
    
    return `<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="utf-8">
  <title>Intakeformulier Export</title>
  <style>
    body { font-family: 'Segoe UI', sans-serif; max-width: 900px; margin: 40px auto; padding: 20px; color: #1A2E28; }
    h1 { color: #1B4D3E; border-bottom: 3px solid #1B4D3E; padding-bottom: 12px; }
    .section { margin: 32px 0; background: #fff; padding: 24px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); }
    h2 { color: #1B4D3E; font-size: 16px; margin: 0 0 16px 0; }
    table { width: 100%; border-collapse: collapse; }
    td { padding: 10px 8px; border-bottom: 1px solid #E8F0ED; vertical-align: top; }
    td:first-child { font-weight: 600; width: 35%; color: #5A6F68; }
  </style>
</head>
<body>
  <h1>Intakeformulier Informatiemanagement</h1>
  ${sectionHtml}
</body>
</html>`;
  }
  
  function exportHtml() {
    const html = buildReportHtml();
    const blob = new Blob([html], { type: 'text/html' });
    const url = URL.createObjectURL(blob);
    const link = document.createElement('a');
    link.href = url;
    link.download = `intake-${new Date().toISOString().slice(0,10)}.html`;
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
    URL.revokeObjectURL(url);
    showToast('HTML export aangemaakt');
  }
  
  function exportWord() {
    const html = buildReportHtml();
    const blob = new Blob(['\ufeff', html], { type: 'application/msword' });
    const url = URL.createObjectURL(blob);
    const link = document.createElement('a');
    link.href = url;
    link.download = `intake-${new Date().toISOString().slice(0,10)}.doc`;
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
    URL.revokeObjectURL(url);
    showToast('Word export aangemaakt');
  }
  
  // ═══════════════════════════════════════════════════════════════════════════
  // TOAST NOTIFICATIONS
  // ═══════════════════════════════════════════════════════════════════════════
  
  function showToast(message) {
    toast.textContent = message;
    toast.classList.add('show');
    setTimeout(() => toast.classList.remove('show'), 2500);
  }
  
  // ═══════════════════════════════════════════════════════════════════════════
  // WIZARD
  // ═══════════════════════════════════════════════════════════════════════════
  
  wizardClose.addEventListener('click', () => {
    wizardOverlay.classList.remove('active');
  });
  
  // ═══════════════════════════════════════════════════════════════════════════
  // AUTO-SAVE (localStorage)
  // ═══════════════════════════════════════════════════════════════════════════
  
  const STORAGE_KEY = 'intake-formulier-v2-autosave';
  
  function autoSave() {
    const data = getFormData();
    localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
  }
  
  function loadAutoSave() {
    const saved = localStorage.getItem(STORAGE_KEY);
    if (saved) {
      try {
        const data = JSON.parse(saved);
        setFormData(data);
      } catch (e) {
        console.warn('Could not load autosave');
      }
    }
  }
  
  // ═══════════════════════════════════════════════════════════════════════════
  // FIELD EVENTS
  // ═══════════════════════════════════════════════════════════════════════════
  
  let saveTimeout;
  
  fields.forEach(field => {
    field.addEventListener('input', () => {
      updateFieldState(field);
      updateProcessDisplay();
      
      clearTimeout(saveTimeout);
      saveTimeout = setTimeout(autoSave, 1000);
    });
    
    field.addEventListener('change', () => {
      updateFieldState(field);
      updateProcessDisplay();
      autoSave();
    });
  });
  
  // ═══════════════════════════════════════════════════════════════════════════
  // INIT
  // ═══════════════════════════════════════════════════════════════════════════
  
  loadAutoSave();
  refreshFieldStates();
  updateProcessDisplay();
  
})();
</script>

</body>
</html>
